<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>

<?import java.net.URL?>
<AnchorPane prefHeight="800.0" prefWidth="1200.0" style="-fx-background-color: #1c1c1e;" stylesheets="@../css/product.css" xmlns="http://javafx.com/javafx/17" xmlns:fx="http://javafx.com/fxml/1" fx:controller="org.example.newchronopos.controller.ProductsController">

    <children>
        <HBox spacing="0" AnchorPane.topAnchor="0" AnchorPane.leftAnchor="0" AnchorPane.rightAnchor="0" AnchorPane.bottomAnchor="0">
            <!-- Sidebar -->
            <VBox prefWidth="200" style="-fx-background-color: #2d2d2d;">
                <padding>
                    <Insets top="20" left="15" right="15" bottom="20" />
                </padding>
                <children>
                    <Label text="CRONOPOS" textFill="white">
                        <font>
                            <Font size="20.0" />
                        </font>
                        <VBox.margin>
                            <Insets bottom="30" />
                        </VBox.margin>
                    </Label>

                    <Button text="Dashboard" styleClass="nav-btn" prefWidth="170"/>
                    <Button text="Transactions" styleClass="nav-btn"/>
                    <Button text="Products" styleClass="nav-btn-selected"/>
                    <Button text="Reports" styleClass="nav-btn"/>
                    <Button text="Settings" styleClass="nav-btn"/>

                    <VBox fx:id="logoutSection" alignment="BOTTOM_LEFT" spacing="10.0" VBox.vgrow="ALWAYS">
                        <Button text="Logout" styleClass="nav-btn" />
                    </VBox>
                </children>
            </VBox>

            <!-- Main Content -->
            <StackPane fx:id="mainContentPane" style="-fx-background-color: #1c1c1e;" HBox.hgrow="ALWAYS">
                <!-- Default Product Listing View -->
                <VBox fx:id="productListingView" spacing="20">
                    <padding>
                        <Insets top="30" left="30" right="30" bottom="30" />
                    </padding>
                    <children>
                        <!-- Header -->
                        <HBox alignment="CENTER_LEFT" spacing="10.0">
                            <Label text="Products" textFill="white">
                                <font>
                                    <Font size="26.0" />
                                </font>
                            </Label>
                            <Region HBox.hgrow="ALWAYS"/>
                            <Button fx:id="btnAddCategory" text="Add New Category" styleClass="action-btn" />
                            <Button fx:id="btnAddProduct" text="Add New Product" styleClass="action-btn" />
                        </HBox>

                        <!-- Categories -->
                        <VBox spacing="10">
                            <Label text="Categories" textFill="white">
                                <font>
                                    <Font size="16.0" />
                                </font>
                            </Label>
                            <HBox fx:id="categoryButtonsContainer" spacing="10" />
                        </VBox>

                        <!-- Product Tabs -->
                        <VBox spacing="10">
                            <Label text="Product Types" textFill="white">
                                <font>
                                    <Font size="16.0" />
                                </font>
                            </Label>
                            <HBox fx:id="productTabsContainer" spacing="10" />
                        </VBox>

                        <!-- Product Table -->
                        <TableView fx:id="productTable" style="-fx-background-color: transparent; ">
                            <columns>
                                <TableColumn fx:id="colImage" text="Image"  prefWidth="60" />
                                <TableColumn fx:id="colName" text="Product Name" prefWidth="200" />
                                <TableColumn fx:id="colSku" text="SKU" prefWidth="120" />
                                <TableColumn fx:id="colCategory" text="Category" prefWidth="120" />
                                <TableColumn fx:id="colBrand" text="Brand" prefWidth="120" />
                                <TableColumn fx:id="colPrice" text="Price" prefWidth="100" />
                                <TableColumn fx:id="colStock" text="Stock" prefWidth="80" />
                                <TableColumn fx:id="colStatus" text="Status" prefWidth="100" />
                                <TableColumn fx:id="colAction" text="Actions" prefWidth="150" />
                            </columns>
                            <columnResizePolicy>
                                <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                            </columnResizePolicy>
                        </TableView>
                    </children>
                </VBox>

                <!-- Add Product View -->
                <HBox fx:id="addProductView" visible="false" style="-fx-background-color: #1c1c1e;">
                    <!-- Step Sidebar -->
                    <VBox fx:id="stepSidebar" style="-fx-background-color: #2a2a2c;" prefWidth="200">
                        <padding>
                            <Insets top="20" left="15" right="15" bottom="20" />
                        </padding>
                        <children>
                            <Label text="Add Product" textFill="white" style="-fx-font-size: 18; -fx-font-weight: bold;">
                                <VBox.margin>
                                    <Insets bottom="20" />
                                </VBox.margin>
                            </Label>

                            <ToggleButton fx:id="stepInfoBtn" text="1. Product Info" toggleGroup="$stepGroup" styleClass="step-btn" userData="info" />
                            <ToggleButton fx:id="stepImagesBtn" text="2. Product Images" toggleGroup="$stepGroup" styleClass="step-btn" userData="images" />
                            <ToggleButton fx:id="stepPricesBtn" text="3. Unit Prices" toggleGroup="$stepGroup" styleClass="step-btn" userData="prices" />
                            <ToggleButton fx:id="stepTaxesBtn" text="4. Taxes" toggleGroup="$stepGroup" styleClass="step-btn" userData="taxes" />
                            <ToggleButton fx:id="stepBarcodesBtn" text="5. Barcodes" toggleGroup="$stepGroup" styleClass="step-btn" userData="barcodes" />
                            <ToggleButton fx:id="stepAttributesBtn" text="6. Attributes" toggleGroup="$stepGroup" styleClass="step-btn" userData="attributes" />

                            <Region VBox.vgrow="ALWAYS" />

                            <Button fx:id="btnCancelAddProduct" text="Cancel" styleClass="cancel-btn" />
                        </children>
                    </VBox>

                    <!-- Step Content -->
                    <StackPane fx:id="stepContentPane" HBox.hgrow="ALWAYS">
                        <padding>
                            <Insets top="20" left="20" right="20" bottom="20" />
                        </padding>

                        <!-- Product Info Step -->
                        <VBox fx:id="infoStep" visible="false" spacing="15" style="-fx-background-color: #1c1c1e;">
                            <Label text="Product Information" style="-fx-text-fill: white; -fx-font-size: 20;" />

                            <GridPane hgap="10" vgap="10">
                                <columnConstraints>
                                    <ColumnConstraints percentWidth="30" />
                                    <ColumnConstraints percentWidth="70" />
                                </columnConstraints>

                                <children>
                                    <Label text="Product Name:" textFill="white" />
                                    <TextField fx:id="productNameField" GridPane.columnIndex="1" />

                                    <Label text="SKU:" textFill="white" GridPane.rowIndex="1" />
                                    <TextField fx:id="skuField" GridPane.columnIndex="1" GridPane.rowIndex="1" />

                                    <Label text="Category:" textFill="white" GridPane.rowIndex="2" />
                                    <ComboBox fx:id="categoryCombo" GridPane.columnIndex="1" GridPane.rowIndex="2" />

                                    <Label text="Brand:" textFill="white" GridPane.rowIndex="3" />
                                    <TextField fx:id="brandField" GridPane.columnIndex="1" GridPane.rowIndex="3" />

                                    <Label text="Purchase Unit:" textFill="white" GridPane.rowIndex="4" />
                                    <TextField fx:id="purchaseUnitField" GridPane.columnIndex="1" GridPane.rowIndex="4" />

                                    <Label text="Selling Unit:" textFill="white" GridPane.rowIndex="5" />
                                    <TextField fx:id="sellingUnitField" GridPane.columnIndex="1" GridPane.rowIndex="5" />

                                    <Label text="Supplier:" textFill="white" GridPane.rowIndex="6" />
                                    <TextField fx:id="supplierField" GridPane.columnIndex="1" GridPane.rowIndex="6" />

                                    <Label text="Product Group:" textFill="white" GridPane.rowIndex="7" />
                                    <TextField fx:id="productGroupField" GridPane.columnIndex="1" GridPane.rowIndex="7" />

                                    <Label text="Reorder Level:" textFill="white" GridPane.rowIndex="8" />
                                    <Spinner fx:id="reorderLevelSpinner" GridPane.columnIndex="1" GridPane.rowIndex="8" />

                                    <Label text="Description:" textFill="white" GridPane.rowIndex="9" />
                                    <TextArea fx:id="descriptionArea" GridPane.columnIndex="1" GridPane.rowIndex="9" />
                                </children>
                            </GridPane>

                            <HBox spacing="10" alignment="BOTTOM_RIGHT">
                                <Button fx:id="btnNextFromInfo" text="Next" styleClass="action-btn" />
                            </HBox>
                        </VBox>

                        <!-- Product Images Step -->
                        <VBox fx:id="imagesStep" visible="false" spacing="15" style="-fx-background-color: #1c1c1e;">
                            <Label text="Product Images" style="-fx-text-fill: white; -fx-font-size: 20;" />

                            <HBox spacing="10">
                                <TextField fx:id="imageUrlField" promptText="Image URL" prefWidth="300" />
                                <Button fx:id="btnAddImage" text="Add Image" styleClass="action-btn" />
                                <Button fx:id="btnChooseImage" text="Choose File" styleClass="action-btn" />
                            </HBox>

                            <ListView fx:id="imagesListView" style="-fx-background-color: #2a2a2c;" prefHeight="200" />

                            <HBox spacing="10" alignment="BOTTOM_RIGHT">
                                <Button fx:id="btnSkipImages" text="Skip" styleClass="cancel-btn" />
                                <Button fx:id="btnNextFromImages" text="Next" styleClass="action-btn" />
                            </HBox>
                        </VBox>

                        <!-- Unit Prices Step -->
                        <VBox fx:id="pricesStep" visible="false" spacing="15" style="-fx-background-color: #1c1c1e;">
                            <Label text="Unit Prices" style="-fx-text-fill: white; -fx-font-size: 20;" />

                            <GridPane hgap="10" vgap="10">
                                <columnConstraints>
                                    <ColumnConstraints percentWidth="30" />
                                    <ColumnConstraints percentWidth="70" />
                                </columnConstraints>

                                <children>
                                    <Label text="Price Type:" textFill="white" />
                                    <ComboBox fx:id="priceTypeCombo" GridPane.columnIndex="1" />

                                    <Label text="Unit Option:" textFill="white" GridPane.rowIndex="1" />
                                    <TextField fx:id="unitOptionField" GridPane.columnIndex="1" GridPane.rowIndex="1" />

                                    <Label text="Cost:" textFill="white" GridPane.rowIndex="2" />
                                    <TextField fx:id="costField" GridPane.columnIndex="1" GridPane.rowIndex="2" />

                                    <Label text="Price:" textFill="white" GridPane.rowIndex="3" />
                                    <TextField fx:id="priceField" GridPane.columnIndex="1" GridPane.rowIndex="3" />

                                    <Label text="Color:" textFill="white" GridPane.rowIndex="4" />
                                    <TextField fx:id="colorField" GridPane.columnIndex="1" GridPane.rowIndex="4" />
                                </children>
                            </GridPane>

                            <Button fx:id="btnAddPrice" text="Add Price" styleClass="action-btn" />

                            <TableView fx:id="pricesTable" style="-fx-background-color: transparent;" prefHeight="150">
                                <columns>
                                    <TableColumn text="Price Type" />
                                    <TableColumn text="Unit Option" />
                                    <TableColumn text="Price" />
                                    <TableColumn text="Actions" />
                                </columns>
                            </TableView>

                            <HBox spacing="10" alignment="BOTTOM_RIGHT">
                                <Button fx:id="btnSkipPrices" text="Skip" styleClass="cancel-btn" />
                                <Button fx:id="btnNextFromPrices" text="Next" styleClass="action-btn" />
                            </HBox>
                        </VBox>

                        <!-- Taxes Step -->
                        <VBox fx:id="taxesStep" visible="false" spacing="15" style="-fx-background-color: #1c1c1e;">
                            <Label text="Product Taxes" style="-fx-text-fill: white; -fx-font-size: 20;" />

                            <GridPane hgap="10" vgap="10">
                                <columnConstraints>
                                    <ColumnConstraints percentWidth="30" />
                                    <ColumnConstraints percentWidth="70" />
                                </columnConstraints>

                                <children>
                                    <Label text="Tax Type:" textFill="white" />
                                    <ComboBox fx:id="taxTypeCombo" GridPane.columnIndex="1" />

                                    <CheckBox fx:id="appliedToSellingCheck" text="Applied to Selling" textFill="white" GridPane.rowIndex="1" GridPane.columnIndex="1" />
                                    <CheckBox fx:id="appliedToBuyingCheck" text="Applied to Buying" textFill="white" GridPane.rowIndex="2" GridPane.columnIndex="1" />
                                    <CheckBox fx:id="includeInPriceCheck" text="Include in Price" textFill="white" GridPane.rowIndex="3" GridPane.columnIndex="1" />
                                </children>
                            </GridPane>

                            <Button fx:id="btnAddTax" text="Add Tax" styleClass="action-btn" />

                            <TableView fx:id="taxesTable" style="-fx-background-color: transparent;" prefHeight="150">
                                <columns>
                                    <TableColumn text="Tax Type" />
                                    <TableColumn text="Applied To" />
                                    <TableColumn text="Actions" />
                                </columns>
                            </TableView>

                            <HBox spacing="10" alignment="BOTTOM_RIGHT">
                                <Button fx:id="btnSkipTaxes" text="Skip" styleClass="cancel-btn" />
                                <Button fx:id="btnNextFromTaxes" text="Next" styleClass="action-btn" />
                            </HBox>
                        </VBox>

                        <!-- Barcodes Step -->
                        <VBox fx:id="barcodesStep" visible="false" spacing="15" style="-fx-background-color: #1c1c1e;">
                            <Label text="Product Barcodes" style="-fx-text-fill: white; -fx-font-size: 20;" />

                            <GridPane hgap="10" vgap="10">
                                <columnConstraints>
                                    <ColumnConstraints percentWidth="30" />
                                    <ColumnConstraints percentWidth="70" />
                                </columnConstraints>

                                <children>
                                    <Label text="Barcode Name:" textFill="white" />
                                    <TextField fx:id="barcodeNameField" GridPane.columnIndex="1" />

                                    <Label text="Barcode:" textFill="white" GridPane.rowIndex="1" />
                                    <TextField fx:id="barcodeField" GridPane.columnIndex="1" GridPane.rowIndex="1" />

                                    <CheckBox fx:id="isDefaultBarcodeCheck" text="Is Default" textFill="white" GridPane.rowIndex="2" GridPane.columnIndex="1" />
                                    <CheckBox fx:id="isStandardBarcodeCheck" text="Is Standard" textFill="white" GridPane.rowIndex="3" GridPane.columnIndex="1" />
                                </children>
                            </GridPane>

                            <Button fx:id="btnAddBarcode" text="Add Barcode" styleClass="action-btn" />

                            <TableView fx:id="barcodesTable" style="-fx-background-color: transparent;" prefHeight="150">
                                <columns>
                                    <TableColumn text="Name" />
                                    <TableColumn text="Barcode" />
                                    <TableColumn text="Default" />
                                    <TableColumn text="Actions" />
                                </columns>
                            </TableView>

                            <HBox spacing="10" alignment="BOTTOM_RIGHT">
                                <Button fx:id="btnSkipBarcodes" text="Skip" styleClass="cancel-btn" />
                                <Button fx:id="btnNextFromBarcodes" text="Next" styleClass="action-btn" />
                            </HBox>
                        </VBox>

                        <!-- Attributes Step -->
                        <VBox fx:id="attributesStep" visible="false" spacing="15" style="-fx-background-color: #1c1c1e;">
                            <Label text="Product Attributes" style="-fx-text-fill: white; -fx-font-size: 20;" />

                            <GridPane hgap="10" vgap="10">
                                <columnConstraints>
                                    <ColumnConstraints percentWidth="30" />
                                    <ColumnConstraints percentWidth="70" />
                                </columnConstraints>

                                <children>
                                    <Label text="Attribute Name:" textFill="white" />
                                    <TextField fx:id="attributeNameField" GridPane.columnIndex="1" />

                                    <Label text="Value:" textFill="white" GridPane.rowIndex="1" />
                                    <TextField fx:id="attributeValueField" GridPane.columnIndex="1" GridPane.rowIndex="1" />

                                    <Label text="Arabic Value:" textFill="white" GridPane.rowIndex="2" />
                                    <TextField fx:id="arabicValueField" GridPane.columnIndex="1" GridPane.rowIndex="2" />
                                </children>
                            </GridPane>

                            <Button fx:id="btnAddAttribute" text="Add Attribute" styleClass="action-btn" />

                            <TableView fx:id="attributesTable" style="-fx-background-color: transparent;" prefHeight="150">
                                <columns>
                                    <TableColumn text="Attribute" />
                                    <TableColumn text="Value" />
                                    <TableColumn text="Arabic Value" />
                                    <TableColumn text="Actions" />
                                </columns>
                            </TableView>

                            <HBox spacing="10" alignment="BOTTOM_RIGHT">
                                <Button fx:id="btnSkipAttributes" text="Skip" styleClass="cancel-btn" />
                                <Button fx:id="btnSubmitProduct" text="Submit Product" styleClass="action-btn" />
                            </HBox>
                        </VBox>
                    </StackPane>
                </HBox>
            </StackPane>
        </HBox>
    </children>

    <fx:define>
        <ToggleGroup fx:id="stepGroup" />
    </fx:define>
</AnchorPane>